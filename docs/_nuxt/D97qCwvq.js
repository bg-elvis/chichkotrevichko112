import{_ as X,T as Y}from"./AwcsWncE.js";import{e as I,x as A,y as q,r as G,f as ss,z as ts,c as i,a as s,q as c,b as as,t as e,n as d,F as E,m as H,w as os,v as k,o as r,A as B,j as ls}from"./mTg0_58q.js";import"./DlAUqK2U.js";const es={class:"pb-5"},ds={class:"py-5"},rs={key:0,class:"py-5"},is=["onClick"],ns={class:"flex items-center"},us=["onClick"],ps={class:"w-full text-left"},gs={class:"p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900"},fs=["innerHTML"],vs={key:1},cs={key:0},ks={class:"pb-5"},ys={class:"py-5"},Cs={class:"py-5"},ws=["onClick"],xs={class:"flex items-center"},bs=["onClick"],hs={class:"w-full text-left"},_s={class:"p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900"},ms=["innerHTML"],$s={key:1},Ms={key:0},Ts={class:"pb-5"},Ds={class:"py-5"},js={class:"py-5"},Ls=["onClick"],Es={class:"flex items-center"},Hs=["onClick"],Bs={class:"w-full text-left"},Vs={class:"p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900"},Zs=["innerHTML"],Fs={key:1,class:"text-sm font-light"},Ss={class:"py-5"},zs=["innerHTML"],J="https://bg-elvis.github.io/chichkotrevichko112-cdn-",K=1e4,Ws=I({__name:"[...eml]",setup(Rs){const{$router:V}=A(),Z=q(()=>{var l;return(l=V.currentRoute.value.params.eml)==null?void 0:l[1]}),F=q(()=>{var l;return(l=V.currentRoute.value.params.eml)==null?void 0:l[0]}),n=G(!1),w=G([]),T=(l="")=>l.substring(0,K),D=async(l,t)=>{for(const y in l.attachments){const f=l.attachments[y],C=f.split(".");C.pop();const v=C.join(".");if(f.endsWith(".eml")||f.endsWith(".msg")||f.endsWith(".dat")){const a=await fetch(`${t}/attachments/${v}/eml.json`).then(p=>p.json());await D(a,`${t}/attachments/${v}`),a.rootUrl=`${t}/attachments/${v}`,l.attachmentsData[y]={isEml:!0,states:a.attachments.map(p=>({state:!1})),data:a}}else if(f.endsWith(".zip")){const a=await fetch(`${t}/attachments/${v}/zip.json`).then(p=>p.json());for(const p in a.attachmentsData){const h=a.attachmentsData[p];h.length>K&&(a.attachmentsData[p]=T(h)+" ...")}await D(a,`${t}/attachments/${v}`),a.rootUrl=`${t}/attachments/${v}`,l.attachmentsData[y]={isZip:!0,states:a.files.map(p=>({state:!1})),data:a}}else l.rootUrl=t}return l};ss(()=>{ts(async()=>{const l=await fetch(`${J}${F.value}/${Z.value}/eml.json`).then(t=>t.json());await D(l,`${J}${F.value}/${Z.value}`),w.value=l.attachments.map(t=>({state:!1})),n.value=l})});const j=l=>l.replace(/[^a-zA-Z0-9_/-@.]/g,""),g=l=>l==null?void 0:l.map(t=>t.name&&j(t.address)?`${t.name} <${j(t.address)}>`:t.name?t.name:j(t.address)).join("; "),Q=l=>{for(const t of w.value.filter((y,f)=>f!==l.i))t.state=!1;w.value[l.i].state=!w.value[l.i].state},S=(l,t)=>{for(const y of t.filter((f,C)=>C!==l.i))y.state=!1;t[l.i].state=!t[l.i].state},L=(l,t)=>{var v,a,p;const f=`/${((v=t==null?void 0:t.data)==null?void 0:v.isZip)?"":"attachments/"}`,C=`${t.rootUrl||((p=(a=t==null?void 0:t.data)==null?void 0:a.data)==null?void 0:p.rootUrl)}${f}${l.file}`;window.open(C,"_blank").focus()};return(l,t)=>{var f,C,v;const y=X;return r(),i("div",{class:k(["text-gray-900 dark:text-white p-2 relative",{"overflow-hidden":!d(n),"h-full":!d(n)}])},[s("div",es,[s("div",null,"From: "+e(g(d(n).from)),1),s("div",null,"To: "+e(g(d(n).to)),1),s("div",null,"CC: "+e(g(d(n).cc)),1),s("div",null,"BCC: "+e(g(d(n).bcc)),1),s("div",null,"Reply To: "+e(g(d(n).replyTo)),1)]),t[13]||(t[13]=s("hr",null,null,-1)),s("div",ds,[s("div",null,"Заглавие: "+e(d(n).subject),1),s("div",null,"Дата: "+e(l.$luxon.DateTime.fromISO(d(n).date).toLocaleString(l.$luxon.DateTime.DATETIME_MED)),1)]),t[14]||(t[14]=s("hr",null,null,-1)),(f=d(n).attachments)!=null&&f.length?(r(),i("div",rs,[t[12]||(t[12]=s("h4",{class:"py-5"},"Прикачени файлове: ",-1)),(r(!0),i(E,null,H((C=d(n).attachments)==null?void 0:C.map((a,p)=>({i:p,file:d(n).attachments[p],data:d(n).attachmentsData[p]})),a=>{var p,h,z,R,N;return r(),i("div",null,[s("h2",null,[s("button",{onClick:o=>Q(a),type:"button",class:k([{"border-b-0":a.i!==d(n).attachments.length-1,"rounded-t-xl":a.i===0,"rounded-b-xl":a.i===d(n).attachments.length-1&&!((p=d(w)[a.i])!=null&&p.state)},"flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3"])},[s("span",ns,[!a.data.isEml&&!a.data.isZip?(r(),i("svg",{key:0,onClick:B(o=>L(a,d(n)),["stop"]),class:"w-5 h-5 me-2 shrink-0",fill:"currentColor",width:"800px",height:"800px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},t[0]||(t[0]=[s("path",{d:"M14 2.26953V6.40007C14 6.96012 14 7.24015 14.109 7.45406C14.2049 7.64222 14.3578 7.7952 14.546 7.89108C14.7599 8.00007 15.0399 8.00007 15.6 8.00007H19.7305M9 15L12 18M12 18L15 15M12 18L12 12M14 2H8.8C7.11984 2 6.27976 2 5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803C4 4.27976 4 5.11984 4 6.8V17.2C4 18.8802 4 19.7202 4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673C6.27976 22 7.11984 22 8.8 22H15.2C16.8802 22 17.7202 22 18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362C20 19.7202 20 18.8802 20 17.2V8L14 2Z",stroke:"#000000","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]),8,us)):c("",!0),s("span",ps,e(a.file),1)]),(r(),i("svg",{"data-accordion-icon":"",class:k([{"rotate-180":!((h=d(w)[a.i])!=null&&h.state)},"w-3 h-3 shrink-0"]),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},t[1]||(t[1]=[s("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5 5 1 1 5"},null,-1)]),2))],10,is)]),s("div",{class:k(["text-sm font-light",{hidden:!((z=d(w)[a.i])!=null&&z.state),"border-b-0":a.i===d(n).attachments.length-1}])},[s("div",gs,[typeof a.data=="string"?(r(),i("p",{key:0,class:"text-sm font-light",innerHTML:T((R=a.data)==null?void 0:R.replaceAll(`
`,"<br>"))},null,8,fs)):typeof a.data=="object"?(r(),i("div",vs,[a.data.isEml?(r(),i("div",cs,[s("div",ks,[s("div",null,"From: "+e(g(a.data.data.from)),1),s("div",null,"To: "+e(g(a.data.data.to)),1),s("div",null,"CC: "+e(g(a.data.data.cc)),1),s("div",null,"BCC: "+e(g(a.data.data.bcc)),1),s("div",null,"Reply To: "+e(g(a.data.data.replyTo)),1)]),t[2]||(t[2]=s("hr",null,null,-1)),s("div",ys,[s("div",null,"Заглавие: "+e(a.data.data.subject),1),s("div",null,"Дата: "+e(l.$luxon.DateTime.fromISO(a.data.data.date).toLocaleString(l.$luxon.DateTime.DATETIME_MED)),1)]),t[3]||(t[3]=s("hr",null,null,-1))])):c("",!0),s("div",Cs,[t[11]||(t[11]=s("h4",{class:"py-5"},"Прикачени файлове: ",-1)),(r(!0),i(E,null,H((N=a.data.data.attachments||a.data.data.files)==null?void 0:N.map((o,x)=>{var _,m;return{i:x,file:((_=a.data.data.attachments)==null?void 0:_[x])||((m=a.data.data.files)==null?void 0:m[x]),data:a.data.data.attachmentsData[x]}}),o=>{var x,_,m,O,P;return r(),i("div",null,[s("h2",null,[s("button",{onClick:u=>S(o,a.data.states),type:"button",class:k([{"border-b-0":o.i!==(a.data.data.attachments||a.data.data.files).length-1,"rounded-t-xl":o.i===0,"rounded-b-xl":o.i===(a.data.data.attachments||a.data.data.files).length-1&&!((x=a.data.states[o.i])!=null&&x.state)},"flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3"])},[s("span",xs,[!o.data.isEml&&!o.data.isZip?(r(),i("svg",{key:0,onClick:B(u=>L(o,a),["stop"]),class:"w-5 h-5 me-2 shrink-0",fill:"currentColor",width:"800px",height:"800px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},t[4]||(t[4]=[s("path",{d:"M14 2.26953V6.40007C14 6.96012 14 7.24015 14.109 7.45406C14.2049 7.64222 14.3578 7.7952 14.546 7.89108C14.7599 8.00007 15.0399 8.00007 15.6 8.00007H19.7305M9 15L12 18M12 18L15 15M12 18L12 12M14 2H8.8C7.11984 2 6.27976 2 5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803C4 4.27976 4 5.11984 4 6.8V17.2C4 18.8802 4 19.7202 4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673C6.27976 22 7.11984 22 8.8 22H15.2C16.8802 22 17.7202 22 18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362C20 19.7202 20 18.8802 20 17.2V8L14 2Z",stroke:"#000000","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]),8,bs)):c("",!0),s("span",hs,e(o.file),1)]),(r(),i("svg",{"data-accordion-icon":"",class:k([{"rotate-180":!((_=a.data.states[o.i])!=null&&_.state)},"w-3 h-3 shrink-0"]),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},t[5]||(t[5]=[s("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5 5 1 1 5"},null,-1)]),2))],10,ws)]),s("div",{class:k(["text-sm font-light",{hidden:!((m=a.data.states[o.i])!=null&&m.state),"border-b-0":o.i===(a.data.data.attachments||a.data.data.files).length-1}])},[s("div",_s,[typeof o.data=="string"?(r(),i("p",{key:0,class:"text-sm font-light",innerHTML:T((O=o.data)==null?void 0:O.replaceAll(`
`,"<br>"))},null,8,ms)):typeof o.data=="object"?(r(),i("div",$s,[o.data.isEml?(r(),i("div",Ms,[s("div",Ts,[s("div",null,"From: "+e(g(o.data.data.from)),1),s("div",null,"To: "+e(g(o.data.data.to)),1),s("div",null,"CC: "+e(g(o.data.data.cc)),1),s("div",null,"BCC: "+e(g(o.data.data.bcc)),1),s("div",null,"Reply To: "+e(g(o.data.data.replyTo)),1)]),t[6]||(t[6]=s("hr",null,null,-1)),s("div",Ds,[s("div",null,"Заглавие: "+e(o.data.data.subject),1),s("div",null,"Дата: "+e(l.$luxon.DateTime.fromISO(o.data.data.date).toLocaleString(l.$luxon.DateTime.DATETIME_MED)),1)]),t[7]||(t[7]=s("hr",null,null,-1))])):c("",!0),s("div",js,[t[10]||(t[10]=s("h4",{class:"py-5"},"Прикачени файлове: ",-1)),(r(!0),i(E,null,H((P=o.data.data.attachments||o.data.data.files)==null?void 0:P.map((u,b)=>{var $,M;return{i:b,file:(($=o.data.data.attachments)==null?void 0:$[b])||((M=o.data.data.files)==null?void 0:M[b]),data:o.data.data.attachmentsData[b]}}),u=>{var b,$,M,W;return r(),i("div",null,[s("h2",null,[s("button",{onClick:U=>S(u,o.data.states),type:"button",class:k([{"border-b-0":u.i!==(o.data.data.attachments||o.data.data.files).length-1,"rounded-t-xl":u.i===0,"rounded-b-xl":u.i===(o.data.data.attachments||o.data.data.files).length-1&&!((b=o.data.states[u.i])!=null&&b.state)},"flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3"])},[s("span",Es,[!u.data.isEml&&!u.data.isZip?(r(),i("svg",{key:0,onClick:B(U=>L(u,o.data.data),["stop"]),class:"w-5 h-5 me-2 shrink-0",fill:"currentColor",width:"800px",height:"800px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},t[8]||(t[8]=[s("path",{d:"M14 2.26953V6.40007C14 6.96012 14 7.24015 14.109 7.45406C14.2049 7.64222 14.3578 7.7952 14.546 7.89108C14.7599 8.00007 15.0399 8.00007 15.6 8.00007H19.7305M9 15L12 18M12 18L15 15M12 18L12 12M14 2H8.8C7.11984 2 6.27976 2 5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803C4 4.27976 4 5.11984 4 6.8V17.2C4 18.8802 4 19.7202 4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673C6.27976 22 7.11984 22 8.8 22H15.2C16.8802 22 17.7202 22 18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362C20 19.7202 20 18.8802 20 17.2V8L14 2Z",stroke:"#000000","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]),8,Hs)):c("",!0),s("span",Bs,e(u.file),1)]),(r(),i("svg",{"data-accordion-icon":"",class:k([{"rotate-180":!(($=o.data.states[u.i])!=null&&$.state)},"w-3 h-3 shrink-0"]),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},t[9]||(t[9]=[s("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5 5 1 1 5"},null,-1)]),2))],10,Ls)]),s("div",{class:k(["text-sm font-light",{hidden:!((M=o.data.states[u.i])!=null&&M.state),"border-b-0":u.i===(o.data.data.attachments||o.data.data.files).length-1}])},[s("div",Vs,[typeof u.data=="string"?(r(),i("p",{key:0,class:"text-sm font-light",innerHTML:T((W=u.data)==null?void 0:W.replaceAll(`
`,"<br>"))},null,8,Zs)):typeof u.data=="object"?(r(),i("p",Fs,e(u.data),1)):c("",!0)])],2)])}),256))])])):c("",!0)])],2)])}),256))])])):c("",!0)])],2)])}),256))])):c("",!0),s("div",Ss,[s("span",{innerHTML:(v=d(n).text)==null?void 0:v.replaceAll(`
`,"<br>")},null,8,zs)]),as(d(Y),null,{default:os(()=>[d(n)?c("",!0):(r(),ls(y,{key:0,class:"z-[1]"}))]),_:1})],2)}}});export{Ws as default};
